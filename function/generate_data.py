#!/usr/bin/env python

"""
-------------------------------------------------
@date：         2021/7/30 10:41
@Author :
@File Name：    generate_data.py
@Description : 生成测试数据
-------------------------------------------------
"""
from util.mysql_conn import MysqlConn

way_bill_numbe_list = [
    'YT2021040100010003',
    'YT2021040100010013',
    'YT2021040100010010',
    'YT2021040100010006',
    'YT2021040100010011',
    'YT2021040100010012',
    'YT2021040100010015',
    'YT2021040100010019',
    'YT2021040100010017',
    'YT2021040100010023',
    'YT2021040100010020',
    'YT2021040100010022',
    'YT2021040100010018',
    'YT2021040100010024',
    'YT2021040100010021',
    'YT2021040100010008',
    'YT2021040100010025',
    'YT2021040100010027',
    'YT2021040100010037',
    'YT2021040100010033',
    'YT2021040100010029',
    'YT2021040100010026',
    'YT2021040100010039',
    'YT2021040100010031',
    'YT2021040100010038',
    'YT2021040100010034',
    'YT2021040100010001',
    'YT2021040100010051',
    'YT2021040100010028',
    'YT2021040100010030',
    'YT2021040100010044',
    'YT2021040100010041',
    'YT2021040100010036',
    'YT2021040100010035',
    'YT2021040100010032',
    'YT2021040100010047',
    'YT2021040100010040',
    'YT2021040100010052',
    'YT2021040100010042',
    'YT2021040100010050',
    'YT2021040100010043',
    'YT2021040100010014',
    'YT2021040100010009',
    'YT2021040100010005',
    'YT2021040100010004',
    'YT2021040100010016',
    'YT2021040100010045',
    'YT2021040100010046',
    'YT2021040100010048',
    'YT2021040100010049',
    'YT2021040100010053',
    'YT2021040100010054',
    'YT2021040100010056',
    'YT2021040100010055',
    'YT2021040100010058',
    'YT2021040100010057',
    'YT2021040100010059',
    'YT2021040100010071',
    'YT2021040100010076',
    'YT2021040100010073',
    'YT2021040100010078',
    'YT2021040100010065',
    'YT2021040100010089',
    'YT2021040100010080',
    'YT2021040100010061',
    'YT2021040100010079',
    'YT2021040100010070',
    'YT2021040100010086',
    'YT2021040100010077',
    'YT2021040100010072',
    'YT2021040100010085',
    'YT2021040100010067',
    'YT2021040100010064',
    'YT2021040100010068',
    'YT2021040100010083',
    'YT2021040100010082',
    'YT2021040100010074',
    'YT2021040100010087',
    'YT2021040100010091',
    'YT2021040100010090',
    'YT2021040100010092',
    'YT2021040100010081',
    'YT2021040100010060',
    'YT2021040100010062',
    'YT2021040100010096',
    'YT2021040100010063',
    'YT2021040100010066',
    'YT2021040100010069',
    'YT2021040100010099',
    'YT2021040100010093',
    'YT2021040100010088',
    'YT2021040100010075',
    'YT2021040100010094',
    'YT2021040100010084',
    'YT2021040100010098',
    'YT2021040100010097',
    'YT2021040100010095',
    'YT2021040100010100',
    'YT2107721236009249',
    'YT-TMS960908290311',
    'YT2021040100020031',
    'YT-TMS960943530052',
    'YT-TIS961433380112',
    'YT-TIS961523160067',
    'YT2021040100030001',
    'YT-TIS971735540001',
    'YT-TIS971801440573',
    'YT2021040100030002',
    'YT2021040100030003',
    'YT2021040100030004',
    'YT2021040100030005',
    'YT2021040100030008',
    'YT2021040100030007',
    'YT2021040100030006',
    'YT2021040100030010',
    'YT2021040100030009',
    'YT2021040100030023',
    'YT2021040100030024',
    'YT2021040100030030',
    'YT2021040100030028',
    'YT2021040100030029',
    'YT2021040100030022',
    'YT2021040100030027',
    'YT2021040100030021',
]
db_info = {
    "db_name": "",
    "host": "",
    "user": "",
    "password": "",
    "port": "",
}
for way_bill_numbe in way_bill_numbe_list:
    mysql_conn = MysqlConn(**db_info)
    result = mysql_conn.select_sql_get_one(
        sql=f"SELECT orderid from trackingorders where WaybillNumber='{way_bill_numbe}'",
        return_format="dict")
    order_id = result.get("orderid")
    if order_id:
        sql_list = [
            f"INSERT INTO `trackingorderdetails_{str(order_id)[-1]}`(`OrderId`, `TrackingIndex`, `TrackingDate`, `TrackingContent`,`TrackingLocation`, `TrackingState`, `LanguageCode`, `CreatedOn`, `TrackingSource`,TrackingCode) VALUES ({order_id}, 1, '2021-07-21 05:14:52', 'Shipping Label Created, USPS Awaiting Item', 'CA', '0', 'EN', '2021-07-29 18:37:25', 0,'1');",
            f"INSERT INTO `trackingorderdetails_{str(order_id)[-1]}`(`OrderId`, `TrackingIndex`, `TrackingDate`, `TrackingContent`,`TrackingLocation`, `TrackingState`, `LanguageCode`, `CreatedOn`, `TrackingSource`,TrackingCode) VALUES ({order_id}, 1, '2021-07-21 04:14:52', 'Arrived Shipping Partner Facility, USPS Awaiting Item', 'CA', '0', 'EN', '2021-07-29 18:37:25', 0,'1');",
            f"INSERT INTO `trackingorderdetails_{str(order_id)[-1]}`(`OrderId`, `TrackingIndex`, `TrackingDate`, `TrackingContent`,`TrackingLocation`, `TrackingState`, `LanguageCode`, `CreatedOn`, `TrackingSource`,TrackingCode) VALUES ({order_id}, 1, '2021-07-21 03:14:52', 'Departed Shipping Partner Facility, USPS Awaiting Item', 'CA', '0', 'EN', '2021-07-29 18:37:25', 0,'1');",
            f"INSERT INTO `trackingorderdetails_{str(order_id)[-1]}`(`OrderId`, `TrackingIndex`, `TrackingDate`, `TrackingContent`,`TrackingLocation`, `TrackingState`, `LanguageCode`, `CreatedOn`, `TrackingSource`,TrackingCode) VALUES ({order_id}, 1, '2021-07-21 06:14:52', 'Accepted at USPS Regional Destination Facility', 'CA', '0', 'EN', '2021-07-29 18:37:25', 0,'1');",
            f"INSERT INTO `trackingorderdetails_{str(order_id)[-1]}`(`OrderId`, `TrackingIndex`, `TrackingDate`, `TrackingContent`,`TrackingLocation`, `TrackingState`, `LanguageCode`, `CreatedOn`, `TrackingSource`,TrackingCode) VALUES ({order_id}, 1, '2021-07-21 07:14:52', 'Arrived at USPS Regional Destination Facility', 'CA', '0', 'EN', '2021-07-29 18:37:25', 0,'1');",
            f"INSERT INTO `trackingorderdetails_{str(order_id)[-1]}`(`OrderId`, `TrackingIndex`, `TrackingDate`, `TrackingContent`,`TrackingLocation`, `TrackingState`, `LanguageCode`, `CreatedOn`, `TrackingSource`,TrackingCode) VALUES ({order_id}, 1, '2021-07-21 08:14:52', 'Departed USPS Regional Facility', 'CA', '0', 'EN', '2021-07-29 18:37:25', 0,'1');",
            f"INSERT INTO `trackingorderdetails_{str(order_id)[-1]}`(`OrderId`, `TrackingIndex`, `TrackingDate`, `TrackingContent`,`TrackingLocation`, `TrackingState`, `LanguageCode`, `CreatedOn`, `TrackingSource`,TrackingCode) VALUES ({order_id}, 1, '2021-07-21 09:14:52', 'Arrived at USPS Facility', 'CA', '0', 'EN', '2021-07-29 18:37:25', 0,'1');",
            f"INSERT INTO `trackingorderdetails_{str(order_id)[-1]}`(`OrderId`, `TrackingIndex`, `TrackingDate`, `TrackingContent`,`TrackingLocation`, `TrackingState`, `LanguageCode`, `CreatedOn`, `TrackingSource`,TrackingCode) VALUES ({order_id}, 1, '2021-07-22 05:14:52', 'Arrived at Post Office', 'CA', '0', 'EN', '2021-07-29 18:37:25', 0,'1');",
            f"INSERT INTO `trackingorderdetails_{str(order_id)[-1]}`(`OrderId`, `TrackingIndex`, `TrackingDate`, `TrackingContent`,`TrackingLocation`, `TrackingState`, `LanguageCode`, `CreatedOn`, `TrackingSource`,TrackingCode) VALUES ({order_id}, 1, '2021-07-22 06:14:52', 'Delivery', 'CA', '0', 'EN', '2021-07-29 18:37:25', 0,'1');",
        ]
        mysql_conn.insert_by_sql(list_sql=sql_list)
        print(f"order id{order_id}插入完成\n")
    else:
        raise Exception("order id is null")
